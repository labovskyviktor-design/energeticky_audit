#!/usr/bin/env python3
"""
JEDNODUCH√Å ENERGY AUDIT GUI APLIK√ÅCIA
S jasne viditeƒæn√Ωm tlaƒçidlom VYKONA≈§ AUDIT
"""

import tkinter as tk
from tkinter import ttk, messagebox, scrolledtext
from datetime import datetime

class SimpleEnergyAuditGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("üè¢ Energetick√Ω Audit Syst√©m")
        self.root.geometry("1000x700")
        self.root.configure(bg='white')
        
        # D√°ta
        self.audit_data = {}
        self.results = {}
        
        self.create_gui()
        
    def create_gui(self):
        """Vytvorenie jednoduch√©ho GUI"""
        
        # HLAVIƒåKY
        header = tk.Frame(self.root, bg='#2c3e50', height=60)
        header.pack(fill=tk.X)
        header.pack_propagate(False)
        
        tk.Label(header, text="üè¢ ENERGETICK√ù AUDIT SYST√âM", 
                font=('Arial', 16, 'bold'), fg='white', bg='#2c3e50').pack(pady=15)
        
        # HLAVN√ù OBSAH
        main_frame = tk.Frame(self.root, bg='white')
        main_frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)
        
        # ƒΩAV√ù PANEL - FORMUL√ÅR
        left_frame = tk.LabelFrame(main_frame, text="üìã ZADANIE √öDAJOV", 
                                  font=('Arial', 12, 'bold'), bg='white')
        left_frame.pack(side=tk.LEFT, fill=tk.BOTH, expand=True, padx=(0, 10))
        
        self.create_input_form(left_frame)
        
        # PRAV√ù PANEL - V√ùSLEDKY
        right_frame = tk.LabelFrame(main_frame, text="üìä V√ùSLEDKY", 
                                   font=('Arial', 12, 'bold'), bg='white')
        right_frame.pack(side=tk.RIGHT, fill=tk.BOTH, expand=True)
        
        self.results_text = scrolledtext.ScrolledText(right_frame, height=25, width=50)
        self.results_text.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
        self.results_text.insert(tk.END, "V√Ωsledky sa zobrazia po vykonan√≠ auditu...")
        
        # SPODN√ù PANEL - VEƒΩK√â TLAƒåIDL√Å
        self.create_bottom_buttons()
        
    def create_input_form(self, parent):
        """Vytvorenie formul√°ra pre vstupn√© √∫daje"""
        
        # Scrollable frame
        canvas = tk.Canvas(parent, bg='white')
        scrollbar = ttk.Scrollbar(parent, orient="vertical", command=canvas.yview)
        scrollable_frame = tk.Frame(canvas, bg='white')
        
        scrollable_frame.bind("<Configure>", lambda e: canvas.configure(scrollregion=canvas.bbox("all")))
        canvas.create_window((0, 0), window=scrollable_frame, anchor="nw")
        canvas.configure(yscrollcommand=scrollbar.set)
        
        # 1. Z√ÅKLADN√â √öDAJE
        basic_frame = tk.LabelFrame(scrollable_frame, text="üè¢ Z√°kladn√© √∫daje", bg='white')
        basic_frame.pack(fill=tk.X, padx=10, pady=5)
        
        tk.Label(basic_frame, text="N√°zov budovy:", bg='white').grid(row=0, column=0, sticky=tk.W, padx=5, pady=3)
        self.building_name = tk.Entry(basic_frame, width=30)
        self.building_name.grid(row=0, column=1, padx=5, pady=3)
        self.building_name.insert(0, "Testovacia budova")
        
        tk.Label(basic_frame, text="Podlahov√° plocha [m¬≤]:", bg='white').grid(row=1, column=0, sticky=tk.W, padx=5, pady=3)
        self.floor_area = tk.Entry(basic_frame, width=30)
        self.floor_area.grid(row=1, column=1, padx=5, pady=3)
        self.floor_area.insert(0, "120")
        
        tk.Label(basic_frame, text="Rok v√Ωstavby:", bg='white').grid(row=2, column=0, sticky=tk.W, padx=5, pady=3)
        self.construction_year = tk.Entry(basic_frame, width=30)
        self.construction_year.grid(row=2, column=1, padx=5, pady=3)
        self.construction_year.insert(0, "2000")
        
        # 2. OB√ÅLKA BUDOVY
        envelope_frame = tk.LabelFrame(scrollable_frame, text="üè† Ob√°lka budovy", bg='white')
        envelope_frame.pack(fill=tk.X, padx=10, pady=5)
        
        tk.Label(envelope_frame, text="Plocha stien [m¬≤]:", bg='white').grid(row=0, column=0, sticky=tk.W, padx=5, pady=3)
        self.wall_area = tk.Entry(envelope_frame, width=30)
        self.wall_area.grid(row=0, column=1, padx=5, pady=3)
        self.wall_area.insert(0, "150")
        
        tk.Label(envelope_frame, text="U-hodnota stien [W/m¬≤K]:", bg='white').grid(row=1, column=0, sticky=tk.W, padx=5, pady=3)
        self.wall_u = tk.Entry(envelope_frame, width=30)
        self.wall_u.grid(row=1, column=1, padx=5, pady=3)
        self.wall_u.insert(0, "0.25")
        
        tk.Label(envelope_frame, text="Plocha okien [m¬≤]:", bg='white').grid(row=2, column=0, sticky=tk.W, padx=5, pady=3)
        self.window_area = tk.Entry(envelope_frame, width=30)
        self.window_area.grid(row=2, column=1, padx=5, pady=3)
        self.window_area.insert(0, "25")
        
        tk.Label(envelope_frame, text="U-hodnota okien [W/m¬≤K]:", bg='white').grid(row=3, column=0, sticky=tk.W, padx=5, pady=3)
        self.window_u = tk.Entry(envelope_frame, width=30)
        self.window_u.grid(row=3, column=1, padx=5, pady=3)
        self.window_u.insert(0, "1.1")
        
        # 3. SYST√âMY
        systems_frame = tk.LabelFrame(scrollable_frame, text="‚öôÔ∏è Syst√©my", bg='white')
        systems_frame.pack(fill=tk.X, padx=10, pady=5)
        
        tk.Label(systems_frame, text="Typ vykurovania:", bg='white').grid(row=0, column=0, sticky=tk.W, padx=5, pady=3)
        self.heating_type = ttk.Combobox(systems_frame, values=["Plynov√Ω kotol", "Elektrick√©", "Tepeln√© ƒçerpadlo"])
        self.heating_type.grid(row=0, column=1, padx=5, pady=3)
        self.heating_type.set("Plynov√Ω kotol")
        
        tk.Label(systems_frame, text="√öƒçinnos≈• vykurovania [%]:", bg='white').grid(row=1, column=0, sticky=tk.W, padx=5, pady=3)
        self.heating_efficiency = tk.Entry(systems_frame, width=30)
        self.heating_efficiency.grid(row=1, column=1, padx=5, pady=3)
        self.heating_efficiency.insert(0, "90")
        
        canvas.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")
        
    def create_bottom_buttons(self):
        """Vytvorenie spodn√Ωch tlaƒçidiel"""
        
        # VEƒΩK√ù SPODN√ù PANEL
        bottom_frame = tk.Frame(self.root, bg='#ecf0f1', height=120)
        bottom_frame.pack(fill=tk.X, side=tk.BOTTOM)
        bottom_frame.pack_propagate(False)
        
        # PROGRESS BAR
        progress_frame = tk.Frame(bottom_frame, bg='#ecf0f1')
        progress_frame.pack(fill=tk.X, pady=10)
        
        tk.Label(progress_frame, text="Priebeh:", bg='#ecf0f1', font=('Arial', 10)).pack(side=tk.LEFT, padx=10)
        self.progress = ttk.Progressbar(progress_frame, mode='determinate')
        self.progress.pack(fill=tk.X, padx=10)
        
        # TLAƒåIDL√Å
        buttons_frame = tk.Frame(bottom_frame, bg='#ecf0f1')
        buttons_frame.pack(fill=tk.X, pady=5)
        
        # HLAVN√â TLAƒåIDLO - VEƒΩK√â A ZELEN√â
        self.audit_button = tk.Button(buttons_frame, 
                                     text="üî¨ VYKONA≈§ ENERGETICK√ù AUDIT",
                                     command=self.perform_audit,
                                     bg='#27ae60', fg='white',
                                     font=('Arial', 16, 'bold'),
                                     width=25, height=2,
                                     relief=tk.RAISED, bd=5)
        self.audit_button.pack(side=tk.LEFT, padx=20)
        
        # OSTATN√â TLAƒåIDL√Å
        tk.Button(buttons_frame, text="üíæ ULO≈ΩI≈§",
                 command=self.save_project, bg='#3498db', fg='white',
                 font=('Arial', 10, 'bold'), width=12, height=2).pack(side=tk.LEFT, padx=5)
        
        tk.Button(buttons_frame, text="üèÖ CERTIFIK√ÅT", 
                 command=self.generate_certificate, bg='#9b59b6', fg='white',
                 font=('Arial', 10, 'bold'), width=12, height=2).pack(side=tk.LEFT, padx=5)
        
        tk.Button(buttons_frame, text="üßÆ POZRIE≈§ V√ùPOƒåET",
                 command=self.show_calculation_details, bg='#f39c12', fg='white',
                 font=('Arial', 10, 'bold'), width=15, height=2).pack(side=tk.LEFT, padx=5)
        
        tk.Button(buttons_frame, text="‚ùå UKONƒåI≈§",
                 command=self.root.quit, bg='#e74c3c', fg='white',
                 font=('Arial', 10, 'bold'), width=12, height=2).pack(side=tk.RIGHT, padx=20)
        
    def collect_data(self):
        """Zber √∫dajov z formul√°ra"""
        try:
            self.audit_data = {
                'building': {
                    'name': self.building_name.get() or "Test budova",
                    'floor_area': float(self.floor_area.get() or 120),
                    'construction_year': int(self.construction_year.get() or 2000)
                },
                'envelope': {
                    'wall_area': float(self.wall_area.get() or 150),
                    'wall_u': float(self.wall_u.get() or 0.25),
                    'window_area': float(self.window_area.get() or 25),
                    'window_u': float(self.window_u.get() or 1.1)
                },
                'systems': {
                    'heating_type': self.heating_type.get() or "Plynov√Ω kotol",
                    'heating_efficiency': float(self.heating_efficiency.get() or 90) / 100
                }
            }
            return True
        except ValueError as e:
            messagebox.showerror("Chyba", f"Neplatn√© √∫daje: {e}")
            return False
        
    def perform_audit(self):
        """HLAVN√Å FUNKCIA - Vykonanie auditu"""
        
        # Zber √∫dajov
        if not self.collect_data():
            return
            
        self.audit_button.config(text="‚è≥ PREBIEHA AUDIT...", state=tk.DISABLED)
        self.progress['value'] = 0
        self.root.update()
        
        try:
            # Simul√°cia v√Ωpoƒçtu
            self.progress['value'] = 25
            self.root.update()
            
            # Z√°kladn√© v√Ωpoƒçty
            building = self.audit_data['building']
            envelope = self.audit_data['envelope']
            systems = self.audit_data['systems']
            
            # Tepeln√© straty
            wall_losses = envelope['wall_area'] * envelope['wall_u']
            window_losses = envelope['window_area'] * envelope['window_u'] 
            total_losses = wall_losses + window_losses
            
            self.progress['value'] = 50
            self.root.update()
            
            # Potreba tepla
            hdd = 2800  # Bratislava
            heating_need = total_losses * hdd * 24 / 1000  # kWh/rok
            
            # Spotreba energie
            heating_energy = heating_need / systems['heating_efficiency']
            electricity = building['floor_area'] * 15  # kWh/m¬≤rok
            total_energy = heating_energy + electricity
            
            self.progress['value'] = 75
            self.root.update()
            
            # Prim√°rna energia a trieda
            primary_energy = heating_energy * 1.1 + electricity * 3.0
            specific_primary = primary_energy / building['floor_area']
            
            # Urƒçenie triedy
            if specific_primary <= 50:
                energy_class = 'A'
            elif specific_primary <= 110:
                energy_class = 'C'  
            elif specific_primary <= 150:
                energy_class = 'D'
            elif specific_primary <= 200:
                energy_class = 'E'
            else:
                energy_class = 'F'
                
            # CO2 emisie
            co2_emissions = heating_energy * 0.202 + electricity * 0.486
            specific_co2 = co2_emissions / building['floor_area']
            
            self.progress['value'] = 100
            self.root.update()
            
            # Ulo≈æenie v√Ωsledkov
            self.results = {
                'total_energy': total_energy,
                'heating_energy': heating_energy, 
                'electricity': electricity,
                'primary_energy': primary_energy,
                'specific_primary': specific_primary,
                'energy_class': energy_class,
                'co2_emissions': co2_emissions,
                'specific_co2': specific_co2,
                'total_losses': total_losses
            }
            
            # Zobrazenie v√Ωsledkov
            self.display_results()
            
            messagebox.showinfo("√öspech", "‚úÖ Energetick√Ω audit dokonƒçen√Ω!")
            
        except Exception as e:
            messagebox.showerror("Chyba", f"Chyba pri v√Ωpoƒçte: {e}")
        finally:
            self.audit_button.config(text="üî¨ VYKONA≈§ ENERGETICK√ù AUDIT", state=tk.NORMAL)
            self.progress['value'] = 0
            
    def display_results(self):
        """Zobrazenie v√Ωsledkov"""
        self.results_text.delete(1.0, tk.END)
        
        building = self.audit_data['building']
        results = self.results
        
        output = f"""
{'='*50}
üìã ENERGETICK√ù AUDIT - V√ùSLEDKY
{'='*50}

üè¢ BUDOVA: {building['name']}
üìê Podlahov√° plocha: {building['floor_area']:.0f} m¬≤
üìÖ Rok v√Ωstavby: {building['construction_year']}

‚ö° ENERGETICK√Å BILANCIA:
‚îú‚îÄ Vykurovanie: {results['heating_energy']:.0f} kWh/rok
‚îú‚îÄ Elektrina: {results['electricity']:.0f} kWh/rok  
‚îî‚îÄ CELKOM: {results['total_energy']:.0f} kWh/rok

üéØ ENERGETICK√â HODNOTENIE:
‚îú‚îÄ Energetick√° trieda: {results['energy_class']}
‚îú‚îÄ Prim√°rna energia: {results['specific_primary']:.1f} kWh/m¬≤rok
‚îú‚îÄ CO2 emisie: {results['specific_co2']:.1f} kg/m¬≤rok
‚îî‚îÄ Tepeln√© straty: {results['total_losses']:.1f} W/K

üí° ODPOR√öƒåANIA:
"""
        
        # Generovanie odpor√∫ƒçan√≠
        recommendations = []
        envelope = self.audit_data['envelope']
        
        if envelope['wall_u'] > 0.30:
            recommendations.append("‚Ä¢ Zateplenie stien (√∫spory 25-35%)")
        if envelope['window_u'] > 2.0:
            recommendations.append("‚Ä¢ V√Ωmena okien (√∫spory 15-20%)")
        if self.audit_data['systems']['heating_efficiency'] < 0.85:
            recommendations.append("‚Ä¢ Moderniz√°cia vykurovania (√∫spory 20-30%)")
        
        if recommendations:
            output += "\n".join(recommendations)
        else:
            output += "‚Ä¢ Budova je v dobrom energetikom stave"
            
        output += f"\n\nüìã CERTIFIK√ÅCIA:\n"
        output += f"üèÖ Energetick√° trieda: {results['energy_class']}\n"
        output += f"‚ö° Prim√°rna energia: {results['specific_primary']:.1f} kWh/m¬≤rok\n"
        output += f"üåç CO2 emisie: {results['specific_co2']:.1f} kg CO2/m¬≤rok\n"
        
        self.results_text.insert(tk.END, output)
        
    def save_project(self):
        """Ulo≈æenie projektu"""
        if not self.audit_data:
            messagebox.showwarning("Upozornenie", "Nie je ƒço ulo≈æi≈•.")
            return
        messagebox.showinfo("Info", "Funkcionalita ukladania bude implementovan√°.")
        
    def generate_certificate(self):
        """Generovanie certifik√°tu"""
        if not self.results:
            messagebox.showwarning("Upozornenie", "Najprv vykonajte audit.")
            return
            
        # Vytvorenie certifik√°tu
        building = self.audit_data['building']
        results = self.results
        
        certificate_info = f"""
üèÖ ENERGETICK√ù CERTIFIK√ÅT

Budova: {building['name']}
ƒå√≠slo certifik√°tu: EC-{datetime.now().strftime('%Y%m%d%H%M')}

Energetick√° trieda: {results['energy_class']}
Prim√°rna energia: {results['specific_primary']:.1f} kWh/m¬≤rok
CO2 emisie: {results['specific_co2']:.1f} kg CO2/m¬≤rok

D√°tum vydania: {datetime.now().strftime('%d.%m.%Y')}
Platnos≈• do: {datetime.now().replace(year=datetime.now().year + 10).strftime('%d.%m.%Y')}
"""
        
        messagebox.showinfo("Certifik√°t", certificate_info)
        
    def show_calculation_details(self):
        """Zobrazenie detailn√Ωch v√Ωpoƒçtov s vzorcami"""
        if not self.audit_data or not self.results:
            messagebox.showwarning("Upozornenie", "Najprv vykonajte audit pre zobrazenie v√Ωpoƒçtov.")
            return
        
        # Vytvorenie nov√©ho okna pre v√Ωpoƒçty
        calc_window = tk.Toplevel(self.root)
        calc_window.title("üßÆ DETAILN√â V√ùPOƒåTY - ENERGETICK√ù AUDIT")
        calc_window.geometry("900x700")
        calc_window.configure(bg='white')
        
        # Header
        header = tk.Frame(calc_window, bg='#34495e', height=50)
        header.pack(fill=tk.X)
        header.pack_propagate(False)
        
        tk.Label(header, text="üßÆ KROK-ZA-KROKOM V√ùPOƒåTY", 
                font=('Arial', 14, 'bold'), fg='white', bg='#34495e').pack(pady=10)
        
        # Scrollable text area
        text_frame = tk.Frame(calc_window)
        text_frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)
        
        calc_text = scrolledtext.ScrolledText(text_frame, font=('Consolas', 10), 
                                              bg='#f8f9fa', wrap=tk.WORD)
        calc_text.pack(fill=tk.BOTH, expand=True)
        
        # Generovanie detailn√Ωch v√Ωpoƒçtov
        calculation_details = self.generate_calculation_details()
        calc_text.insert(tk.END, calculation_details)
        calc_text.config(state=tk.DISABLED)
        
        # Tlaƒçidlo na zatvorenie
        tk.Button(calc_window, text="‚ùå Zavrie≈•", command=calc_window.destroy,
                 bg='#e74c3c', fg='white', font=('Arial', 12, 'bold')).pack(pady=10)
                 
    def generate_calculation_details(self):
        """Generovanie detailn√©ho opisu v√Ωpoƒçtov s vzorcami"""
        building = self.audit_data['building']
        envelope = self.audit_data['envelope']
        systems = self.audit_data['systems']
        results = self.results
        
        # V√Ωpoƒçet hodn√¥t krok za krokom
        wall_losses = envelope['wall_area'] * envelope['wall_u']
        window_losses = envelope['window_area'] * envelope['window_u']
        total_losses = wall_losses + window_losses
        
        hdd = 2800  # Bratislava
        heating_need = total_losses * hdd * 24 / 1000
        heating_energy = heating_need / systems['heating_efficiency']
        electricity = building['floor_area'] * 15
        total_energy = heating_energy + electricity
        
        primary_energy = heating_energy * 1.1 + electricity * 3.0
        specific_primary = primary_energy / building['floor_area']
        
        co2_emissions = heating_energy * 0.202 + electricity * 0.486
        specific_co2 = co2_emissions / building['floor_area']
        
        details = f"""
{'='*80}
üßÆ DETAILN√â V√ùPOƒåTY ENERGETICK√âHO AUDITU
{'='*80}

üìä VSTUPN√â √öDAJE:
{'‚îÄ'*40}
üè¢ Budova: {building['name']}
üìê Podlahov√° plocha (Af): {building['floor_area']:.1f} m¬≤
üìÖ Rok v√Ωstavby: {building['construction_year']}
üß± Plocha stien (Aw): {envelope['wall_area']:.1f} m¬≤
üß± U-hodnota stien (Uw): {envelope['wall_u']:.3f} W/m¬≤K
ü™ü Plocha okien (Aok): {envelope['window_area']:.1f} m¬≤
ü™ü U-hodnota okien (Uok): {envelope['window_u']:.3f} W/m¬≤K
‚öôÔ∏è  Typ vykurovania: {systems['heating_type']}
‚öôÔ∏è  √öƒçinnos≈• vykurovania (Œ∑h): {systems['heating_efficiency']*100:.1f}%

{'='*80}
üìà KROK 1: V√ùPOƒåET TEPELN√ùCH STR√ÅT
{'='*80}

üìê VZOREC: Tepeln√© straty = S√∫ƒçet (Plocha √ó U-hodnota)

üß± Tepeln√© straty stenami:
   Qw = Aw √ó Uw
   Qw = {envelope['wall_area']:.1f} m¬≤ √ó {envelope['wall_u']:.3f} W/m¬≤K
   Qw = {wall_losses:.2f} W/K

ü™ü Tepeln√© straty oknami:
   Qok = Aok √ó Uok
   Qok = {envelope['window_area']:.1f} m¬≤ √ó {envelope['window_u']:.3f} W/m¬≤K
   Qok = {window_losses:.2f} W/K

üìä CELKOV√â TEPELN√â STRATY:
   Qtotal = Qw + Qok
   Qtotal = {wall_losses:.2f} + {window_losses:.2f}
   Qtotal = {total_losses:.2f} W/K

{'='*80}
üìà KROK 2: POTREBA TEPLA NA VYKUROVANIE
{'='*80}

üìê VZOREC: Qh = Qtotal √ó HDD √ó 24 / 1000
   kde: HDD = Heating Degree Days (stup≈àov√© dni vykurovania)

üå°Ô∏è  Heating Degree Days (Bratislava): {hdd} K¬∑de≈à/rok

üî• Potreba tepla na vykurovanie:
   Qh = {total_losses:.2f} W/K √ó {hdd} K¬∑de≈à/rok √ó 24 h/de≈à √∑ 1000
   Qh = {heating_need:.0f} kWh/rok

{'='*80}
üìà KROK 3: SPOTREBA ENERGIE NA VYKUROVANIE
{'='*80}

üìê VZOREC: Eh = Qh / Œ∑h
   kde: Œ∑h = √∫ƒçinnos≈• vykurovacieho syst√©mu

‚öôÔ∏è  Spotreba energie na vykurovanie:
   Eh = {heating_need:.0f} kWh/rok √∑ {systems['heating_efficiency']:.2f}
   Eh = {heating_energy:.0f} kWh/rok

{'='*80}
üìà KROK 4: SPOTREBA ELEKTRICKEJ ENERGIE
{'='*80}

üìê VZOREC: Eel = Af √ó 15 kWh/m¬≤rok (≈°tandardn√° hodnota)

üí° Spotreba elektrickej energie:
   Eel = {building['floor_area']:.1f} m¬≤ √ó 15 kWh/m¬≤rok
   Eel = {electricity:.0f} kWh/rok

{'='*80}
üìà KROK 5: CELKOV√Å SPOTREBA ENERGIE
{'='*80}

üìê VZOREC: Etotal = Eh + Eel

‚ö° Celkov√° spotreba energie:
   Etotal = {heating_energy:.0f} + {electricity:.0f}
   Etotal = {total_energy:.0f} kWh/rok

{'='*80}
üìà KROK 6: PRIM√ÅRNA ENERGIA
{'='*80}

üìê VZOREC: Ep = Eh √ó fp,h + Eel √ó fp,el
   kde: fp,h = faktor prim√°rnej energie pre vykurovanie
        fp,el = faktor prim√°rnej energie pre elektrinu

üî¢ Faktory prim√°rnej energie:
   - Vykurovanie (plyn): fp,h = 1.1
   - Elektrina: fp,el = 3.0

üéØ Prim√°rna energia:
   Ep = {heating_energy:.0f} √ó 1.1 + {electricity:.0f} √ó 3.0
   Ep = {heating_energy * 1.1:.0f} + {electricity * 3.0:.0f}
   Ep = {primary_energy:.0f} kWh/rok

üìä ≈†pecifick√° prim√°rna energia:
   ep = Ep / Af
   ep = {primary_energy:.0f} kWh/rok √∑ {building['floor_area']:.1f} m¬≤
   ep = {specific_primary:.1f} kWh/m¬≤rok

{'='*80}
üìà KROK 7: ENERGETICK√Å TRIEDA
{'='*80}

üìê KLASIFIK√ÅCIA PODƒΩA STN EN 16247:
   A: ‚â§ 50 kWh/m¬≤rok    (Veƒæmi √∫sporn√°)
   B: ‚â§ 75 kWh/m¬≤rok    (√ösporn√°)
   C: ‚â§ 110 kWh/m¬≤rok   (Vyhovuj√∫ca)
   D: ‚â§ 150 kWh/m¬≤rok   (Nevyhovuj√∫ca)
   E: ‚â§ 200 kWh/m¬≤rok   (Ne√∫sporn√°)
   F: ‚â§ 250 kWh/m¬≤rok   (Veƒæmi ne√∫sporn√°)
   G: > 250 kWh/m¬≤rok   (Mimoriadne ne√∫sporn√°)

üèÖ HODNOTENIE:
   ≈†pecifick√° prim√°rna energia: {specific_primary:.1f} kWh/m¬≤rok
   Energetick√° trieda: {results['energy_class']}

{'='*80}
üìà KROK 8: CO2 EMISIE
{'='*80}

üìê VZOREC: CO2 = Eh √ó fCO2,h + Eel √ó fCO2,el
   kde: fCO2,h = emisn√Ω faktor pre vykurovanie
        fCO2,el = emisn√Ω faktor pre elektrinu

üåç Emisn√© faktory:
   - Vykurovanie (plyn): fCO2,h = 0.202 kg CO2/kWh
   - Elektrina: fCO2,el = 0.486 kg CO2/kWh

üå± CO2 emisie:
   CO2 = {heating_energy:.0f} √ó 0.202 + {electricity:.0f} √ó 0.486
   CO2 = {heating_energy * 0.202:.0f} + {electricity * 0.486:.0f}
   CO2 = {co2_emissions:.0f} kg CO2/rok

üìä ≈†pecifick√© CO2 emisie:
   co2 = CO2 / Af
   co2 = {co2_emissions:.0f} kg CO2/rok √∑ {building['floor_area']:.1f} m¬≤
   co2 = {specific_co2:.1f} kg CO2/m¬≤rok

{'='*80}
üìã S√öHRN V√ùSLEDKOV
{'='*80}

üè¢ BUDOVA: {building['name']}
üìê Podlahov√° plocha: {building['floor_area']:.0f} m¬≤

‚ö° ENERGETICK√Å BILANCIA:
‚îú‚îÄ Potreba tepla: {heating_need:.0f} kWh/rok
‚îú‚îÄ Spotreba na vykurovanie: {heating_energy:.0f} kWh/rok
‚îú‚îÄ Spotreba elektrickej energie: {electricity:.0f} kWh/rok
‚îî‚îÄ CELKOV√Å SPOTREBA: {total_energy:.0f} kWh/rok

üéØ ENERGETICK√â HODNOTENIE:
‚îú‚îÄ Prim√°rna energia: {primary_energy:.0f} kWh/rok
‚îú‚îÄ ≈†pecifick√° prim√°rna energia: {specific_primary:.1f} kWh/m¬≤rok
‚îú‚îÄ Energetick√° trieda: {results['energy_class']}
‚îî‚îÄ Tepeln√© straty: {total_losses:.2f} W/K

üåç ENVIRONMENT√ÅLNY DOPAD:
‚îú‚îÄ CO2 emisie: {co2_emissions:.0f} kg CO2/rok
‚îî‚îÄ ≈†pecifick√© CO2 emisie: {specific_co2:.1f} kg CO2/m¬≤rok

{'='*80}
üìö POU≈ΩIT√â NORMY A ≈†TANDARDY:
{'='*80}

‚Ä¢ STN EN 16247-1: Energetick√© audity - ƒåas≈• 1: V≈°eobecn√© po≈æiadavky
‚Ä¢ STN EN ISO 13790: Energetick√° n√°roƒçnos≈• budov
‚Ä¢ Vyhl√°≈°ka MH SR ƒç. 364/2012 Z. z. o energetickej n√°roƒçnosti budov
‚Ä¢ STN 73 0540: Tepeln√° ochrana budov

üìñ POZN√ÅMKY:
‚Ä¢ HDD hodnota 2800 K¬∑de≈à/rok je typick√° pre Bratislavu
‚Ä¢ Faktory prim√°rnej energie s√∫ v s√∫lade s platnou legislat√≠vou SR
‚Ä¢ Emisn√© faktory zodpovedaj√∫ aktu√°lnym hodnot√°m pre SR
‚Ä¢ ≈†tandardn√° spotreba elektrickej energie 15 kWh/m¬≤rok pre obytn√© budovy

{'='*80}
Koniec detailn√©ho v√Ωpoƒçtu - {datetime.now().strftime('%d.%m.%Y %H:%M')}
{'='*80}
"""
        
        return details

def main():
    """Spustenie aplik√°cie"""
    root = tk.Tk()
    app = SimpleEnergyAuditGUI(root)
    root.mainloop()

if __name__ == "__main__":
    main()